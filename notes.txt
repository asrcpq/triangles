fix bug in scaling

todo:
grayscale sampler
